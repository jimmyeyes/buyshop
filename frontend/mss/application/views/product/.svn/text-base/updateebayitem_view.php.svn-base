<?= $menu ?>

<script>
function SelZero(vall){
    var arr=new Array();
    var arr2=new Array();
    <?php 
            $string="";
            $val="";
           
		   for($i=0;$i<4;$i++){
			if($row->amount==""){
				 $sql = "select max(productid) as productid ,amountother from product where currencyid ='".$i."'";
            	$queryarr = $this->db->query($sql);
            	foreach ($queryarr->result() as $rowarr) {
                    echo "arr[".$i."] = '".$rowarr->amountother."';";
           		 }
			}else{
				$arr=array('usamount','ukamount','auamount','amountother');
				 $sql = "select ".$arr[$i]." as amountother from product where productid ='".$row->productid."'";
            	$queryarr = $this->db->query($sql);
            	foreach ($queryarr->result() as $rowarr) {
                    echo "arr[".$i."] = '".$rowarr->amountother."';";
           		 }
			}
		   }
    ?>
$("#amountother").val(arr[vall]);
}

function check_all(obj,cName) 
{ 
    var checkboxs = document.getElementsByName(cName); 
   // alert(checkboxs.length);
    for(var i=0;i<checkboxs.length;i++){checkboxs[i].checked = obj.checked;} 
} 
</script>
<div id="subnavbar"></div>
<div id="content">
		<div class="box themed_box">
		<h2 class="box-header">Update eBay Item</h2>
		<div class="box-content">
			<form action="<?php echo $adminurl; ?>product_edit_update" method="post">
				<label> 品牌： </label>
				<input class="form-field 10px" type="text" value="<?php echo $row -> brand; ?>"  name="brand">
            
               <label > 商品類別 </label>
            <?
            echo "<select name='categoryid'>";
            $sql = "select * from category";

            $query = $this->db->query($sql);
			 echo "<option value=''></option> ";
            foreach ($query->result() as $row2) {
                echo "<option value='{$row2->categoryid}' ";
                if ($row2->categoryid == $row->categoryid) {
                    echo "selected='selected'";
                }
                echo ">{$row2->category}</option>";
            }
            echo "</select>";
            ?>

				<label > 品名： </label>
				<input class="form-field small" type="text" value="<?php echo $row -> prodname; ?>"  name="prodname">

				<label > 型號： </label>
				<input class="form-field 20px" type="text" value="<?php echo $row -> model ?>" name="model">
				
			</div>
	</div>	
				
	<div class="box themed_box">
		<h2 class="box-header">ebay ItemList </h2>
		<div class="box-content">
			  <?php echo form_open_multipart('product/updateebayitem'); ?>
         	  <label class="form-label"> Item ID: </label>

          	<?  $sql="select m.*,r1.username from  productonebay m left join accounttoken r1 on m.accounttokenid=r1.accounttokenid  where m.productid = $id ";
          		$query=$this->db->query($sql);
				foreach($query->result() as $rowv){
          	?>
          			<input type="text" class="form-field 10" value="<?=$rowv->ItemID ?>" name='ItemID'>
          			<input type="text" class="form-field 10" value="<?=$rowv->username ?>" name='username'>
          			<input type="hidden" value="<?=$rowv->accounttokenid ?>" name='accounttokenid'>
          			<a target="_blank" href='http://cgi.sandbox.ebay.com/ws/eBayISAPI.dll?ViewItem&item=<?=$rowv->ItemID?>'>(CHECK ITEM<?=$rowv->ItemID?>)</a>

          			ENDDATE:
          			<?
          			$itemdetail=	$this->all_model->product_ebay_get_item($rowv->accounttokenid,$rowv->ItemID);
          			//echo $itemdetail;
					
					$xml=simplexml_load_string($itemdetail);
					echo $xml->Item->ListingDetails->EndTime;
					
          			?>
          			
          			
          			<br />
          	<? }?>
          
            </form>
			<div class="clear"></div>
		</div>
	</div>
	
	
	<div  class="box themed_box">
        <h2 class="box-header">ebay Data</h2>
        <div class="box-content">
            <?php echo form_open_multipart('product/addItem'); ?>
            
              <label class="form-label"> ebay ID: </label>
         
             <select name="accounttokenid">
          	<?  $sql="select * from  accounttoken  ";
          		$query=$this->db->query($sql);
				foreach($query->result() as $rowv){
          	?>
          			<option
          			<?
          			if($row->accounttokenid ==$rowv->accounttokenid){
          				?>
          				selected
          				<?
          			}
          			?>
          			 value='<?=$rowv->accounttokenid?>'><?=$rowv->username?></option>
          	<? }?>
          	</select>
            
           
                <label class="form-label"> Category: </label>
            <input type="text" class="form-field 10" value="<?=$row->category?>" name="category" size="20" />
             <a href='http://listings.ebay.com/_W0QQloctZShowCatIdsQQsacatZQ2d1QQsalocationZatsQQsocmdZListingCategoryList'>Select Category</a>
            <br>
            
              <label class="form-label"> Condition: </label>
         	 <select name="condition">
          	<?  $sql="select * from  varlist where type=2 ";
          		$query=$this->db->query($sql);
				foreach($query->result() as $rowv){
          	?>
          			<option
          			<?
          			if($row->ConditionID ==$rowv->no){
          				?>
          				selected
          				<?
          			}
          			?>
          			
          			 value='<?=$rowv->no?>'><?=$rowv->name?></option>
          	<? }?>
          	</select>
              <br>
              
              
                 <label class="form-label"> Country: </label>
                <select name="Country">
          <? if($row->Country=="US"){?>
          		<option selected value='US'>US</option>
         	 	<option  value='TW'>TW</option> 
         	 <?}else{?>
         	 	<option value='US'>US</option>
         	 	<option selected  value='TW'>TW</option>
         	 	
         	 <?}?>
          	</select>
              <br>
              
                <label class="form-label"> PaymentMethods: </label>
                <select name="PaymentMethods">
          		<option value='PayPal'>PayPal</option>
          	</select>
              <br>

               <label class="form-label"> PayPalEmailAddress: </label>
            <input type="text" class="form-field 30" value="<?=$row->PayPalEmailAddress?>" name="PayPalEmailAddress" size="20" />
               <br>
              
               <label class="form-label"> Price: </label>
            <input type="text" class="form-field 10" value="<?=$row->StartPrice?>" name="StartPrice" size="20" />US Dollar
              <select name="pricetype">
          
            <? if($row->pricetype=="auction"){?>
          		 <option selected value='auction'>auction</option>
         	 	<option  value='fix'>fixed-price</option>
         	 <?}else{?>
         		 <option value='auction'>auction</option>
         	 	<option selected value='fix'>fixed-price</option>
         	 	
         	 <?}?>
          	</select>
            
            
              <br>
               <label class="form-label"> Quantity: </label>
           	 <input type="text" class="form-field 10"  value="<?=$row->Quantity?>"  name="quantity" size="20" />
             <br>
             
                <label class="form-label"> ListingDuration: </label>
         	 <select name="ListingDuration">
          	<?  $sql="select * from  varlist where type=3 ";
          		$query=$this->db->query($sql);
				foreach($query->result() as $rowv){
          	?>
          			<option
          			<?
          			if($row->ListingDuration ==$rowv->no){
          				?>
          				selected
          				<?
          			}
          			?>
          			
          			 value='<?=$rowv->no?>'><?=$rowv->name?></option>
          	<? }?>
          	</select>
              <br>
              
                <label class="form-label"> ReturnsAcceptedOption: </label>
         	 <select name="ReturnsAcceptedOption">
         	 	
  
          	 <? if($row->ReturnsAcceptedOption=="ReturnsAccepted"){?>
          		<option selected value='ReturnsAccepted'>ReturnsAccepted</option>
					<option value='ReturnsNotAccepted'>ReturnsNotAccepted</option>        
         	 <?}else{?>
         			<option  value='ReturnsAccepted'>ReturnsAccepted</option>
					<option selected value='ReturnsNotAccepted'>ReturnsNotAccepted</option>  
         	 	
         	 <?}?>
          		</select>
              <br>
              
                 <label class="form-label"> RefundOption: </label>
         	 <select name="RefundOption">
          	<?  $sql="select * from  varlist where type=4 ";
          		$query=$this->db->query($sql);
				foreach($query->result() as $rowv){
          	?>
          			<option
          			
          			<?
          			if($row->RefundOption ==$rowv->no){
          				?>
          				selected
          				<?
          			}
          			?>
          			 value='<?=$rowv->no?>'><?=$rowv->name?></option>
          	<? }?>
          	</select>
              <br>
             
             
             
              <label class="form-label"> ReturnsWithinOption: </label>
         	 <select name="ReturnsWithinOption">
          	<?  $sql="select * from  varlist where type=5 ";
          		$query=$this->db->query($sql);
				foreach($query->result() as $rowv){
          	?>
          			<option
          			<?
          			if($row->ReturnsWithinOption ==$rowv->no){
          				?>
          				selected
          				<?
          			}
          			?>
          			
          			 value='<?=$rowv->no?>'><?=$rowv->name?></option>
          	<? }?>
          	</select>
              <br>
              
               <label class="form-label"> Description: </label>
              <textarea name="Description"   id="spec" cols="" rows=""><?=$row->ReturnsDescription?></textarea>				

 		<br>	

   			<label class="form-label"> ShippingType: </label>
         	 <select name="ShippingType">
          	<?  $sql="select * from  varlist where type=6 ";
          		$query=$this->db->query($sql);
				foreach($query->result() as $rowv){
          	?>
          			<option
          			
          			<?
          			if($row->ShippingType ==$rowv->no){
          				?>
          				selected
          				<?
          			}
          			?>
          			 value='<?=$rowv->no?>'><?=$rowv->name?></option>
          	<? }?>
          	</select>
              <br>
              
              
              
               <label class="form-label"> FreeShipping: </label>
         	 <select name="FreeShipping">
         	 	
  
          	 <? if($row->FreeShipping=="1"){?>
          		<option selected value='1'>1</option>
					 <option  value='0'>0</option>
         	 <?}else{?>
         	 	<option  value='1'>1</option>
         			<option selected  value='0'>0</option>
				
         	 	
         	 <?}?>
          		</select>
              <br>
              

	    <label class="form-label"> ShippingCostPaidByOption: </label>
         	 <select name="ShippingCostPaidByOption">
         	 	
  
          	 <? if($row->ShippingCostPaidByOption=="Buyer"){?>
          		<option selected value='Buyer'>Buyer</option>
					 
         	 <?}else{?>
         			<option  value='Buyer'>Buyer</option>
				
         	 	
         	 <?}?>
          		</select>
              <br>

	
		<label class="form-label"> ShippingServicePriority: </label>
         	 <select name="ShippingServicePriority">
          	<?  
				for($i=0;$i<6;$i++){
          	?>
          			<option
          			<?
          			if($row->ShippingServicePriority ==$i){
          				?>
          				selected
          				<?
          			}
          			?>
          			
          			 value='<?=$i?>'><?=$i?></option>
          	<? }?>
          	</select>
              <br>
	
		<label class="form-label"> ShippingService: </label>
         	 <select name="ShippingService">
          	<?  $sql="select * from  varlist where type=7 ";
          		$query=$this->db->query($sql);
				foreach($query->result() as $rowv){
          	?>
          			<option
          			
          			<?
          			if($row->ShippingService ==$rowv->no){
          				?>
          				selected
          				<?
          			}
          			?>
          			 value='<?=$rowv->no?>'><?=$rowv->name?></option>
          	<? }?>
          	</select>
              <br>
              
              <label class="form-label"> ShippingServiceCost: </label>
	 		 <input type="text" class="form-field 10" name="ShippingServiceCost" value="<?=$row->ShippingServiceCost?>" size="20" />
		  <br>
		  
		  
		  <label class="form-label"> InternationalShippingServiceOption: </label>
		  
		   	<label class="form-label"> InternationalShipToLocation: </label>
         	 <select name="InternationalShipToLocation">
          	<?  $sql="select * from  varlist where type=8 ";
          		$query=$this->db->query($sql);
				foreach($query->result() as $rowv){
          	?>
          			<option
          			
          			<?
          			if($row->InternationalShipToLocation ==$rowv->no){
          				?>
          				selected
          				<?
          			}
          			?>
          			 value='<?=$rowv->no?>'><?=$rowv->name?></option>
          	<? }?>
          	</select>
              <br>
		  
		  
		  	<label class="form-label"> InternationalShippingService: </label>
         	 <select name="InternationalShippingService">
          	<?  $sql="select * from  varlist where type=7 ";
          		$query=$this->db->query($sql);
				foreach($query->result() as $rowv){
          	?>
          			<option
          			
          			<?
          			if($row->InternationalShippingService ==$rowv->no){
          				?>
          				selected
          				<?
          			}
          			?>
          			 value='<?=$rowv->no?>'><?=$rowv->name?></option>
          	<? }?>
          	</select>
              <br>
		  
		<label class="form-label"> InternationalShippingServicePriority: </label>
         	 <select name="InternationalShippingServicePriority">
          	<?  
				for($i=0;$i<6;$i++){
          	?>
          			<option
          			<?
          			if($row->InternationalShippingServicePriority ==$i){
          				?>
          				selected
          				<?
          			}
          			?>
          			
          			 value='<?=$i?>'><?=$i?></option>
          	<? }?>
          	</select>
              <br>
              <label class="form-label"> InternationalShippingServiceCost: </label>
	 		 <input type="text" class="form-field 10" name="ShippingServiceCost" value="<?=$row->InternationalShippingServiceCost?>" size="20" />
		  <br>
		  
               <label class="form-label"> DispatchTimeMax: </label>
	 		 <input type="text" class="form-field 10" name="DispatchTimeMax" value="<?=$row->DispatchTimeMax?>" size="20" />
		  <br>

			   <input name="ListingType" type="hidden" value="FixedPriceItem">
            <input name="id" type="hidden" value="<?php echo $id; ?>">
            <input type="submit"  class="button white" value="更新 ebay 資料" />
            </form>
        </div>
      </div> 
	
	    <div  class="box themed_box">
        <h2 class="box-header">Update ebay pic</h2>
        <div class="box-content">
            <?php echo form_open_multipart('product/product_ebay_pic_update'); ?>
           
              <input name="productid" type="hidden" value="<?php echo $id; ?>">
           	 <input name="itemid" type="hidden" value="<?php echo $itemid; ?>">
           	 <input name="accounttokenid" type="hidden" value="<?php echo $accounttokenid; ?>">
             <input type="submit"  class="button white" value="Update ebay pic" />
             </form>
             
             <?
             $itemdetail=	$this->all_model->product_ebay_get_item($accounttokenid,$itemid);
          //	echo $itemdetail;
					
			$xml=simplexml_load_string($itemdetail);
            	$imgurl= $xml->Item->PictureDetails->PictureURL; 
             if($imgurl){
             	?>
             	<img src="<?=$imgurl?>" width="300px" />
             	<?
             }
             ?>
             
        </div>
      </div>
    
</div>



